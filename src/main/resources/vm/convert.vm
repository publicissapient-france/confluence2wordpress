#*
 * Copyright 2011 Alexandre Dutra
 *
 *    Licensed under the Apache License, Version 2.0 (the "License");
 *    you may not use this file except in compliance with the License.
 *    You may obtain a copy of the License at
 *
 *        http://www.apache.org/licenses/LICENSE-2.0
 *
 *    Unless required by applicable law or agreed to in writing, software
 *    distributed under the License is distributed on an "AS IS" BASIS,
 *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *    See the License for the specific language governing permissions and
 *    limitations under the License.
 *#
<html>
<head>
    <title>$action.getText("confluence2wordpress.converter")</title>
    <meta name="decorator" content="atl.general"/>
    #requireResource("fr.xebia.confluence2wordpress:confluence2wordpress-resources")
</head>
<body>

#if ($action.displayCreationMessage || $action.displayUpdateMessage)
    <div class="aui-message success closeable shadowed">
        <p class="title">
            <span class="aui-icon icon-success"></span>
            <strong>
            #if ($action.displayCreationMessage)
            $action.getText("convert.msg.creation.success")
            #else
            $action.getText("convert.msg.update.success")
            #end
            </strong>
        </p>
        <p><a href="$action.permaLink" target="_blank">$action.getText("convert.link.viewPost")</a></p>
        <p><a href="$action.editLink" target="_blank">$action.getText("convert.link.editPost")</a></p>
    </div>   
#end

<form id="options" action="post.action" method="post" class="aui long-label">

    <input name="pageId" type="hidden" value="$action.pageId" />

    <h2>$action.getText("convert.form.title.conversionOptions")</h2>
    
    <div class="field-group">
        <label>$action.getText("convert.form.pageToTranslate")</label>
        <span class="field-value"><a href="$settingsManager.globalSettings.baseUrl/$action.page.urlPath"><strong>$action.page.displayTitle</strong> (v. $action.page.version - ID $action.pageId)</a></span>
    </div>    
    
    <div class="field-group">
        <label for="pageTitle">$action.getText("convert.form.pageTitle.label")</label>
        <input id="pageTitle" name="pageTitle" type="text" value="$action.pageTitle" class="text"/>
    </div>    
    
    <div class="field-group">    
        <label for="resourcesBaseUrl">$action.getText("convert.form.resourcesBaseUrl.label")</label>
        <input id="resourcesBaseUrl" name="resourcesBaseUrl" type="text" value="$!action.resourcesBaseUrl" class="text long-field"/>
    </div>
    
    <div class="field-group">
        <label for="ignoreConfluenceMacros">$action.getText("convert.form.ignoreConfluenceMacros.label")</label>
        <input id="ignoreConfluenceMacros" name="ignoreConfluenceMacros" type="text" value="$action.ignoreConfluenceMacros" class="text" />
    </div>    
    
    <fieldset class="group">
      <div class="checkbox">
        <input id="optimizeForRDP" name="optimizeForRDP" type="checkbox" class="checkbox" #if($action.optimizeForRDP)checked="checked"#end />
        <label for="optimizeForRDP">$action.getText("convert.form.optimizeForRDP.label")</label>
      </div>
    </fieldset>

    <h2>$action.getText("convert.form.title.postOptions")</h2>
    
    <div class="field-group">
        <label for="postId">
            $action.getText("convert.form.postId.label")
        </label>
        <input type="text" id="postId" name="postId" class="text" value="$!action.postId" />
        <div class="description">$action.getText("convert.form.postId.description")</div>
    </div>
    
    <div class="field-group">
        <label for="postSlug">
            $action.getText("convert.form.postSlug.label")
        </label>
        <input type="text" id="postSlug" name="postSlug" class="text" value="$!action.postSlug" />
        <div class="description">$action.getText("convert.form.postSlug.description")</div>
    </div>
    
    <div class="field-group">
        <label for="wordpressUserId">
            $action.getText("convert.form.wordpressUserId.label")
            <span class="form-icon aui-icon icon-required"/>
        </label>
        <select id="wordpressUserId" name="wordpressUserId" class="select">
            #foreach($wordpressUser in $action.wordpressUsers)
                <option value="$wordpressUser.id" #if( $wordpressUser.id == $action.wordpressUserId ) selected="true" #end >$!wordpressUser.displayName $!wordpressUser.firstName $!wordpressUser.lastName</option>
            #end
        </select>
    </div>
    
    <div class="field-group">
        <label for="wordpressCategoryIds">
            $action.getText("convert.form.wordpressCategoryIds.label")
            <span class="form-icon aui-icon icon-required"/>
        </label>
        <select id="wordpressCategoryIds" name="wordpressCategoryIds" multiple="true" class="multi-select">
            #foreach($wordpressCategory in $action.wordpressCategories)
                <option value="$wordpressCategory.id" #if( $action.wordpressCategoryIds.contains($wordpressCategory.id.toString()) ) selected="true" #end >$wordpressCategory.categoryName</option>
            #end
        </select>
    </div>
    
    <div class="field-group">
        <label for="wordpressTagNames">
            $action.getText("convert.form.wordpressTagNames.label")
            <span class="form-icon aui-icon icon-required"/>
        </label>
        <select id="wordpressTagIds" name="wordpressTagNames" multiple="true" class="multi-select">
            #foreach($wordpressTag in $action.wordpressTags)
                <option value="$wordpressTag.name" #if( $action.wordpressTagNames.contains($wordpressTag.name) ) selected="true" #end >$wordpressTag.name</option>
            #end
        </select>
    </div>
        
    <div class="buttons-container">
      <div class="buttons">
        <input type="submit" class="button submit" value="$action.getText("convert.form.button.post")" onclick="this.form.target='_self';this.form.action='post.action'" />
        <input type="submit" class="button submit" value="$action.getText("convert.form.button.preview")" onclick="this.form.target='_blank';this.form.action='preview.action'" />
        <a href="settings.action?pageUrl=convert.action?pageId=$action.pageId">$action.getText("convert.form.link.settings")</a>
        &nbsp;|&nbsp;
        <a class="cancel texticon" href="$settingsManager.globalSettings.baseUrl/$action.page.urlPath">$action.getText("convert.form.link.cancel")</a>
      </div>
    </div>
    
</form>

</body>
</html>